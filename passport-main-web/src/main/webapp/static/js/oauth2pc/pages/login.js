/*
 * JavaScript MD5 1.0
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 * 
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */

/*! http://mths.be/placeholder v2.0.7 by @mathias */

/*
 * $Id: base64.js,v 2.12 2013/05/06 07:54:20 dankogai Exp dankogai $
 *
 *  Licensed under the MIT license.
 *    http://opensource.org/licenses/mit-license
 *
 *  References:
 *    http://en.wikipedia.org/wiki/Base64
 */

(function(e){function t(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function n(e,t){return e<<t|e>>>32-t}function r(e,r,i,s,o,u){return t(n(t(t(r,e),t(s,u)),o),i)}function i(e,t,n,i,s,o,u){return r(t&n|~t&i,e,t,s,o,u)}function s(e,t,n,i,s,o,u){return r(t&i|n&~i,e,t,s,o,u)}function o(e,t,n,i,s,o,u){return r(t^n^i,e,t,s,o,u)}function u(e,t,n,i,s,o,u){return r(n^(t|~i),e,t,s,o,u)}function a(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var r,a,f,l,c,h=1732584193,p=-271733879,d=-1732584194,v=271733878;for(r=0;r<e.length;r+=16)a=h,f=p,l=d,c=v,h=i(h,p,d,v,e[r],7,-680876936),v=i(v,h,p,d,e[r+1],12,-389564586),d=i(d,v,h,p,e[r+2],17,606105819),p=i(p,d,v,h,e[r+3],22,-1044525330),h=i(h,p,d,v,e[r+4],7,-176418897),v=i(v,h,p,d,e[r+5],12,1200080426),d=i(d,v,h,p,e[r+6],17,-1473231341),p=i(p,d,v,h,e[r+7],22,-45705983),h=i(h,p,d,v,e[r+8],7,1770035416),v=i(v,h,p,d,e[r+9],12,-1958414417),d=i(d,v,h,p,e[r+10],17,-42063),p=i(p,d,v,h,e[r+11],22,-1990404162),h=i(h,p,d,v,e[r+12],7,1804603682),v=i(v,h,p,d,e[r+13],12,-40341101),d=i(d,v,h,p,e[r+14],17,-1502002290),p=i(p,d,v,h,e[r+15],22,1236535329),h=s(h,p,d,v,e[r+1],5,-165796510),v=s(v,h,p,d,e[r+6],9,-1069501632),d=s(d,v,h,p,e[r+11],14,643717713),p=s(p,d,v,h,e[r],20,-373897302),h=s(h,p,d,v,e[r+5],5,-701558691),v=s(v,h,p,d,e[r+10],9,38016083),d=s(d,v,h,p,e[r+15],14,-660478335),p=s(p,d,v,h,e[r+4],20,-405537848),h=s(h,p,d,v,e[r+9],5,568446438),v=s(v,h,p,d,e[r+14],9,-1019803690),d=s(d,v,h,p,e[r+3],14,-187363961),p=s(p,d,v,h,e[r+8],20,1163531501),h=s(h,p,d,v,e[r+13],5,-1444681467),v=s(v,h,p,d,e[r+2],9,-51403784),d=s(d,v,h,p,e[r+7],14,1735328473),p=s(p,d,v,h,e[r+12],20,-1926607734),h=o(h,p,d,v,e[r+5],4,-378558),v=o(v,h,p,d,e[r+8],11,-2022574463),d=o(d,v,h,p,e[r+11],16,1839030562),p=o(p,d,v,h,e[r+14],23,-35309556),h=o(h,p,d,v,e[r+1],4,-1530992060),v=o(v,h,p,d,e[r+4],11,1272893353),d=o(d,v,h,p,e[r+7],16,-155497632),p=o(p,d,v,h,e[r+10],23,-1094730640),h=o(h,p,d,v,e[r+13],4,681279174),v=o(v,h,p,d,e[r],11,-358537222),d=o(d,v,h,p,e[r+3],16,-722521979),p=o(p,d,v,h,e[r+6],23,76029189),h=o(h,p,d,v,e[r+9],4,-640364487),v=o(v,h,p,d,e[r+12],11,-421815835),d=o(d,v,h,p,e[r+15],16,530742520),p=o(p,d,v,h,e[r+2],23,-995338651),h=u(h,p,d,v,e[r],6,-198630844),v=u(v,h,p,d,e[r+7],10,1126891415),d=u(d,v,h,p,e[r+14],15,-1416354905),p=u(p,d,v,h,e[r+5],21,-57434055),h=u(h,p,d,v,e[r+12],6,1700485571),v=u(v,h,p,d,e[r+3],10,-1894986606),d=u(d,v,h,p,e[r+10],15,-1051523),p=u(p,d,v,h,e[r+1],21,-2054922799),h=u(h,p,d,v,e[r+8],6,1873313359),v=u(v,h,p,d,e[r+15],10,-30611744),d=u(d,v,h,p,e[r+6],15,-1560198380),p=u(p,d,v,h,e[r+13],21,1309151649),h=u(h,p,d,v,e[r+4],6,-145523070),v=u(v,h,p,d,e[r+11],10,-1120210379),d=u(d,v,h,p,e[r+2],15,718787259),p=u(p,d,v,h,e[r+9],21,-343485551),h=t(h,a),p=t(p,f),d=t(d,l),v=t(v,c);return[h,p,d,v]}function f(e){var t,n="";for(t=0;t<e.length*32;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function l(e){var t,n=[];n[(e.length>>2)-1]=undefined;for(t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<e.length*8;t+=8)n[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32;return n}function c(e){return f(a(l(e),e.length*8))}function h(e,t){var n,r=l(e),i=[],s=[],o;i[15]=s[15]=undefined,r.length>16&&(r=a(r,e.length*8));for(n=0;n<16;n+=1)i[n]=r[n]^909522486,s[n]=r[n]^1549556828;return o=a(i.concat(l(t)),512+t.length*8),f(a(s.concat(o),640))}function p(e){var t="0123456789abcdef",n="",r,i;for(i=0;i<e.length;i+=1)r=e.charCodeAt(i),n+=t.charAt(r>>>4&15)+t.charAt(r&15);return n}function d(e){return unescape(encodeURIComponent(e))}function v(e){return c(d(e))}function m(e){return p(v(e))}function g(e,t){return h(d(e),d(t))}function y(e,t){return p(g(e,t))}function b(e,t,n){return t?n?g(t,e):y(t,e):n?v(e):m(e)}typeof define=="function"&&define.amd?define("lib/md5",[],function(){return b}):e.md5=b})(this),define("lib/utils",[],function(){return{uuid:function(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()},addZero:function(e,t){e=e.toString();while(e.length<t)e="0"+e;return e},parseResponse:function(data){if(typeof data=="string")try{data=eval("("+data+")")}catch(e){data={status:-1,statusText:"服务器故障"}}return data},addIframe:function(e,t){var n=document.createElement("iframe");n.src=e,n.style.position="absolute",n.style.top="1px",n.style.left="1px",n.style.width="1px",n.style.height="1px",n.attachEvent?n.attachEvent("onload",function(){t&&t()}):n.onload=function(){t&&t()},document.body.appendChild(n)},getScript:function(e,t){var n=document.createElement("script"),r=document.head;n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(e,r){if(r||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,r||t()},r.insertBefore(n,r.firstChild)},getUrlByMail:function(e){e=e.split("@")[1];if(!e)return!1;var t={"139.com":"mail.10086.cn","gmail.com":"mail.google.com","sina.com":"mail.sina.com.cn","yeah.net":"www.yeah.net","hotmail.com":"www.hotmail.com","live.com":"www.outlook.com","live.cn":"www.outlook.com","live.com.cn":"www.outlook.com","outlook.com":"www.outlook.com","yahoo.com.cn":"mail.cn.yahoo.com","yahoo.cn":"mail.cn.yahoo.com","ymail.com":"www.ymail.com","eyou.com":"www.eyou.com","188.com":"www.188.com","foxmail.com":"www.foxmail.com"},n;return e in t?n=t[e]:n="mail."+e,"http://"+n}}}),define("lib/common",[],function(){return location.origin||(location.origin=location.protocol+"//"+location.host),{interfaces:{sendSms:"/web/sendsms",checkNeedCaptcha:"/web/login/checkNeedCaptcha",checkSname:"/oauth2/checkregname",checkMobile:"/oauth2/checkregname",login:"/oauth2/login",register:"/oauth2/register",mobileRegister:"/oauth2/register",deleteLoginHistory:"/a/sogou/loginhistory/delete"},retStatus:{checkSname:{10002:"必填参数错误",20201:"此帐号已注册，请直接登录",20217:"暂不支持邮箱注册",20225:"该手机号已注册或已绑定，请直接登录",20241:" 暂不支持sohu域内邮箱注册 "},login:{10001:"系统级错误",10002:"参数错误,请输入必填的参数或参数验证失败",10009:"帐号不存在",20205:"账号不存在",20221:" 验证码验证失败",20231:"登陆账号未激活",20232:"登陆账号被封杀",20230:"当前账号或者IP登陆操作存在异常",20206:"账号或密码错误",20226:"用户登录失败",20240:"生成cookie失败"},sendSms:{10001:"未知错误",10002:"参数错误,请输入必填的参数或参数验证失",20229:"号未登录，请先登",20243:"SOHU域用户不允许此",20244:"第三方账号不允许此",20225:"手机号已绑定其他",20209:"今日验证码校验错误次数已超过",20202:"今日手机短信发送次数超过",20204:"一分钟内只能发一条",20213:"手机验证码发送"},register:{10002:"必填参数错误",20199:"当前注册ip次数已达上限或该ip已在黑名单中",20227:"密码必须为字母和数字且长度大于6位 ",20224:"当日注册次数已达上",20221:"验证码验证失败",10001:"未知错误",10010:"client_id不存在 ",20214:"用户注册失败",20201:"此帐号已注册，请直接登录",20230:"前账号或者IP操作存在异常"}},validObj:{account:{defaultMsg:"帐号/手机号/邮箱",errMsg:"该登录名不存在",emptyMsg:"请填写登录名",nullable:!1,regStr:/^\S{4,50}$/},phone:{errMsg:"请正确填写手机号",emptyMsg:"手机号不能为空",nullable:!1,regStr:/^1\d{10,13}$/},email:{errMsg:"请正确输入邮箱（非必填）",emptyMsg:"",nullable:!0,regStr:/^(\w)+(\.\w+)*@([\w_\-])+((\.\w+)+)$/},password:{errMsg:"密码必须是6-16位字母、数字、下划线的组合",emptyMsg:"请输入6-16位密码",nullable:!1,regStr:/^\w{6,16}$/},vcode:{errMsg:"请正确输入验证码",emptyMsg:"验证码不能为空",nullable:!1,regStr:/^\w*$/},regacc:{errMsg:"必须是小写字母开头的4-16位字母、数字、“.”及“-”的组合",emptyMsg:"请填写帐号",nullable:!1,regStr:/^[a-z][a-zA-Z0-9-\.]{3,15}$/},vcode:{errMsg:"验证码错误，请重新输入",emptyMsg:"请输入验证码",nullable:!1}},exPassport:function(){return window.external&&window.external.passport?window.external.passport:function(){var e=$.noop;window.console&&console.log&&console.log("the method '"+arguments[0]+"' is not supported in your browser ,make sure you using sogou-browser when see this page"),e()}}(),check:function(e,t){var n=this,r=e.next("span.position-tips"),i=e.val(),s=t.nullable,o=t.regStr,u=t.emptyMsg,a=t.errMsg;return e.attr("name")=="vcode"&&(r=e.next("span.chkbtn-wrap").find(">span.chktext")),!s&&i==""?(e.addClass("error"),r.html(u).show(),!1):s&&i==""?(e.removeClass("error"),r.html("").hide(),!0):o.test(i)?(e.removeClass("error"),r.html("").hide(),!0):(e.addClass("error"),r.html(a).show(),!1)}}}),function(e,t,n){function f(e){var t={},r=/^jQuery\d+$/;return n.each(e.attributes,function(e,n){n.specified&&!r.test(n.name)&&(t[n.name]=n.value)}),t}function l(e,r){var i=this,s=n(i);if((i.value==s.prop("placeholder")||i.value==s.attr("placeholder"))&&s.hasClass("placeholder"))if(s.data("placeholder-password")){s=s.hide().next().show().attr("id",s.removeAttr("id").data("placeholder-id"));if(e===!0)return s[0].value=r;s.focus()}else i.value="",s.removeClass("placeholder"),i==t.activeElement&&i.select()}function c(){var e,t=this,r=n(t),i=r,s=this.id;if(t.value==""){if(t.type=="password"){if(!r.data("placeholder-textinput")){try{e=r.clone().attr({type:"text"})}catch(o){e=n("<input>").prop(n.extend(f(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":s}).bind("focus.placeholder",l),r.data({"placeholder-textinput":e,"placeholder-id":s}).before(e)}r=r.removeAttr("id").hide().prev().attr("id",s).show()}r.addClass("placeholder"),r[0].value=r.prop("placeholder")||r.attr("placeholder")}else r.removeClass("placeholder")}var r="placeholder"in t.createElement("input"),i="placeholder"in t.createElement("textarea"),s=n.fn,o=n.valHooks,u,a;r&&i?(a=s.placeholder=function(){return this},a.input=a.textarea=!0):(a=s.placeholder=function(){var e=this;return e.filter((r?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":l,"blur.placeholder":c}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},a.input=r,a.textarea=i,u={get:function(e){var t=n(e);return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,r){var i=n(e);return i.data("placeholder-enabled")?(r==""?(e.value=r,e!=t.activeElement&&c.call(e)):i.hasClass("placeholder")?l.call(e,!0,r)||(e.value=r):e.value=r,i):e.value=r}},r||(o.input=u),i||(o.textarea=u),n(function(){n(t).delegate("form","submit.placeholder",function(){var e=n(".placeholder",this).each(l);setTimeout(function(){e.each(c)},10)})}),n(e).bind("beforeunload.placeholder",function(){n(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery),define("lib/placeholder",function(){}),function(e){if(e.Base64)return;var t="2.1.2",n;typeof module!="undefined"&&module.exports&&(n=require("buffer").Buffer);var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=function(e){var t={};for(var n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(r),s=String.fromCharCode,o=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?s(192|t>>>6)+s(128|t&63):s(224|t>>>12&15)+s(128|t>>>6&63)+s(128|t&63)}var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return s(240|t>>>18&7)+s(128|t>>>12&63)+s(128|t>>>6&63)+s(128|t&63)},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,a=function(e){return e.replace(u,o)},f=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),i=[r.charAt(n>>>18),r.charAt(n>>>12&63),t>=2?"=":r.charAt(n>>>6&63),t>=1?"=":r.charAt(n&63)];return i.join("")},l=e.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,f)},c=n?function(e){return(new n(e)).toString("base64")}:function(e){return l(a(e))},h=function(e,t){return t?c(e).replace(/[+\/]/g,function(e){return e=="+"?"-":"_"}).replace(/=/g,""):c(e)},p=function(e){return h(e,!0)},d=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),v=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return s((n>>>10)+55296)+s((n&1023)+56320);case 3:return s((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return s((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},m=function(e){return e.replace(d,v)},g=function(e){var t=e.length,n=t%4,r=(t>0?i[e.charAt(0)]<<18:0)|(t>1?i[e.charAt(1)]<<12:0)|(t>2?i[e.charAt(2)]<<6:0)|(t>3?i[e.charAt(3)]:0),o=[s(r>>>16),s(r>>>8&255),s(r&255)];return o.length-=[0,0,2,1][n],o.join("")},y=e.atob||function(e){return e.replace(/[\s\S]{1,4}/g,g)},b=n?function(e){return(new n(e,"base64")).toString()}:function(e){return m(y(e))},w=function(e){return b(e.replace(/[-_]/g,function(e){return e=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};e.Base64={VERSION:t,atob:y,btoa:l,fromBase64:w,toBase64:h,utob:a,encode:h,encodeURI:p,btou:m,decode:w};if(typeof Object.defineProperty=="function"){var E=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};e.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",E(function(){return w(this)})),Object.defineProperty(String.prototype,"toBase64",E(function(e){return h(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",E(function(){return h(this,!0)}))}}}(this),define("lib/base64",function(){}),define("app/login",["lib/md5","lib/utils","lib/common","lib/placeholder","lib/base64"],function(e,t,n){function i(e){if(typeof e=="string"||e&&e.constructor==String){try{e=$.parseJSON(e)}catch(t){e={}}return e}return{}}var r=window.splus&&splus._client_id||1044,s={constructor:s,submited:!1,firstVisit:!0,init:function(){this.exPassport("size","604","360"),this.initEvents(),this.initLoginHistory(),this.initDropdownEvents(),this.refreshVcode($(".chkPic img"))},sogouBaseurl:location.origin,initEvents:function(){var e=this,t=$("div.login-con>form"),n=e.exPassport;this.$form=t,t.on("submit",function(e){return!1}).on("click","button.btn",function(t){return e.doLogin(),!1}).on("focus","input",function(e){var t=$(e.target);t.removeClass("error"),t.next("span.position-tips").html(""),$("#out_error").empty().hide()}).on("blur","input[name=account]",function(t){var n=$(t.target);if(!n.val())return;if(!e.check(n,e.validObj.account)){e.submited=!1;return}$.ajax({url:e.sogouBaseurl+e.interfaces.checkNeedCaptcha,data:{username:n.val(),client_id:r},type:"get",dataType:"json"}).done(function(e){e=i(e),e.data&&e.data.needCaptcha?$("div.vcode-area").show():$("div.vcode-area").show()})}).on("blur","[name=password]",function(t){var n=$(t.target);if(!n.val())return;if(!e.check(n,e.validObj.password)){e.submited=!1;return}}).on("click","div.chkPic>img",function(t){var n=$(t.target);e.refreshVcode(n)}).on("click","div.chkPic>span>a",function(e){$("div.chkPic>img",t).trigger("click")}).on("click","i.outside-arrow",function(e){e.stopPropagation(),$(e.target).closest("div.selected").next("ul.outside-list").toggle()}).on("click","[oauth-type]",function(e){var t=$(this),r=t.find(">i"),i=t.attr("oauth-type"),s=r.attr("oauth");switch(i){case"qq":n("size","715","385"),window.location.href=s;break;case"weibo":n("size","650","325"),window.location.href=s;break;case"renren":n("size","500","275"),window.location.href=s;break;case"taobao":n("size","450","475"),window.location.href=s;break;default:}}).on("click",".position-tips",function(e){$(e.target).hide().empty().prev("input").removeClass("error").focus()}),$(document).click(function(e){$("i.outside-arrow").closest("div.selected").next("ul.outside-list").hide()})},initDropdownEvents:function(){var e=this,t=e.list,n=-1,r=e.sogouBaseurl+e.interfaces.deleteLoginHistory,i=e.$form,s=$("input[name=account]",i),o=$("div.ppselecter");s.on("blur",function(e){}).on("keydown",function(e){var t=$(e.delegateTarget),r=o.find("ul>li"),i=$(".select-btn");switch(e.keyCode){case 9:o.is(":visible")&&$("ul>li[class=hover]",o).trigger("click");break;case 38:e.preventDefault();if(o.is(":visible"))if(n<=0)r.removeClass("hover"),n=r.length,t.val("");else{var s=$("ul>li[index="+ --n+"]",o);s.addClass("hover"),s.siblings().removeClass("hover");var u=s.find("div.caption>p.id").html();u&&(u=u.replace(/<b>(\S*)<\/b>/,"$1"),t.val(u))}break;case 40:e.preventDefault(),o.is(":visible")||o.show();if(n>=r.length-1)t.val(""),r.removeClass("hover"),n=-1;else{var s=$("ul>li[index="+ ++n+"]",o);s.addClass("hover"),s.siblings().removeClass("hover");var u=s.find("div.caption>p.id").html();u&&(u=u.replace(/<b>(\S*)<\/b>/,"$1"),t.val(u))}}}).on("click",function(e){e.stopPropagation()}).on("input",function(n){n.stopPropagation();var r=$.trim($(this).val()),i=$.map(t,function(e){var t,n=$.trim(e.sname).replace(/<b>(\S*)<\/b>/,"$1"),i=n.indexOf(r);return i>-1?{img:e.img,sname:n.substr(0,i)+"<b>"+r+"</b>"+n.substr(i+r.length),nick:e.nick,type:e.type,sid:e.sid}:null});if(i.length<1){o.hide();return}e.renderSelect(o,i),o.show()}),i.on("click",".select-btn",function(e){e.stopPropagation(),s.focus(),o.toggle()}),$(window).on("click",function(e){o.hide(function(){$("ul>li",o).removeClass("hover")}),e.stopPropagation()}),o.on("mouseenter","ul li",function(e){$(this).addClass("hover"),$(this).siblings().removeClass("hover")}).on("click","ul",function(n){n.stopPropagation();var u=$(n.target);if(u.closest("[sid]").length>0){var a=u.closest("[sid]"),f=a.attr("sid");$.post(r,{sid:f}).done(function(n){var r=[];$.each(t,function(e,t){t.sid!=f&&r.push(t)}),e.list=r,o.hide(function(){$("ul>li",o).removeClass("hover")}),s.focus(),e.getHistorySelect()})}if(u.closest("[sid]").length<1&&u.closest("li").length>0){var l=u.closest("li"),c=$("input[name=password]",i),h=$("p.id",l).html(),p=h.replace(/<b>(\S*)<\/b>/,"$1");s.val(p),o.hide(function(){$("ul>li",o).removeClass("hover")})}})},doLogin:function(){if(this.submited)return;this.submited=!0;var t=this,n=t.exPassport,s=!1,o=t.$form,u=$("input[name=account]",o),a=u.next("span.position-tips"),f=$("input[name=password]",o),l=f.next("span.position-tips"),c=$("input[name=vcode]",o),h=c.next("span.position-tips"),p=$("div.chkPic>img",o),d=$("#forget_pw"),v=$("#out_error");if(!t.checkEmpty(u,a))return this.submited=!1,!1;if(!t.check(u,t.validObj.account))return this.submited=!1,!1;if(!t.checkEmpty(f,l))return this.submited=!1,!1;if(!t.check(f,t.validObj.password)){this.submited=!1;return}if(c.is(":visible")){s=!0;if(!t.checkEmpty(c,h))return this.submited=!1,!1}var m,g=splus?splus.instanceid:"",y=e(f.val()),b=d.is(":checked")?1:0;m={loginname:u.val(),pwd:y,rememberMe:b,client_id:r,instanceid:g,token:p.attr("data-token")},s&&(m.captcha=c.val()),$.ajax({url:t.sogouBaseurl+t.interfaces.login,data:m,type:"post",dataType:"json"}).done(function(e){t.submited=!1,e=i(e);var n=e.status,r=e.data;switch(!0){case 0==n:var o=r.logintype+"|"+r.result+"|"+r.accesstoken+"|"+r.refreshtoken+"|"+(r.sname||r.uniqname)+"|"+r.nick+"|"+r.sid+"|"+r.passport+"|"+(r.autologin||1);console.log("logintype|result|accToken|refToken|sname|nick|是否公用电脑|是否自动登陆|是否保存\n "+o),window.external&&window.external.passport&&window.external.passport("result",o);break;default:/(10009|20205)/.test(n)?u.addClass("error").next(".position-tips").html(t.retStatus[n]).show():20206==n?f.addClass("error").next(".position-tips").text(t.retStatus.login[n]).show():20221==n?c.addClass("error").next(".position-tips").text(t.retStatus.login[n]).show():v.html(t.retStatus.login[n]||e.statusText||"未知错误").show(),f.val(""),s&&c.val(""),s&&t.refreshVcode(p)}}).fail(function(e){t.submited=!1})},checkEmpty:function(e,t){return e.val()==""?(e.addClass("error"),t.html("不能为空"),!1):!0},refreshVcode:function(e){var n=+(new Date),r=t.uuid(),i="/captcha?token="+r+"&t="+n;e.attr("src",i).attr("data-token",r)},initLoginHistory:function(){var e=[],t=splus?splus.login_history:null;this.formatHistoryData(t),this.getHistorySelect()},getHistorySelect:function(){var e=$("div.ppselecter"),t=this,n=this.list;n&&n.length&&n.length>0?$(".select-btn").show():$(".select-btn").hide(),t.renderSelect(e,n)},renderSelect:function(e,t){var n=this;e.empty();var r=$("<ul></ul>");$.each(t,function(e,t){var n=['<li index="'+e+'">','   <div class="photo">','       <img src="'+t.img+'">',"   </div>",'   <div class="caption">','       <p class="id">'+t.sname+"</p>","   </div>",'   <a href="javascript:" class="del" sid="'+t.sid+'" title="删除">×</a>',"</li>"].join("");r.append(n)}),e.append(r)},formatHistoryData:function(e){var t=[];e&&(login_arr=e.split("|"),login_arr.length>0&&$.each(login_arr,function(e,n){var r,i=n.split(",");for(var s=0;s<i.length;s++)r={img:i[3],sname:i[1],nick:i[2],type:i[4],sid:i[0]};t.push(r)})),this.list=t}};return $.extend(s,n),s}),require(["app/login"],function(e){e.init()}),define("pages/login",function(){})