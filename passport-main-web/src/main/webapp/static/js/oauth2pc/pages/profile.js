/*
 * JavaScript MD5 1.0
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 * 
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */

/*! http://mths.be/placeholder v2.0.7 by @mathias */

/*
 * $Id: base64.js,v 2.12 2013/05/06 07:54:20 dankogai Exp dankogai $
 *
 *  Licensed under the MIT license.
 *    http://opensource.org/licenses/mit-license
 *
 *  References:
 *    http://en.wikipedia.org/wiki/Base64
 */

/*
 * jQuery UI Widget 1.10.1+amd
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */

/*
 * jQuery File Upload Plugin 5.32.6
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

(function(e){function t(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function n(e,t){return e<<t|e>>>32-t}function r(e,r,i,s,o,u){return t(n(t(t(r,e),t(s,u)),o),i)}function i(e,t,n,i,s,o,u){return r(t&n|~t&i,e,t,s,o,u)}function s(e,t,n,i,s,o,u){return r(t&i|n&~i,e,t,s,o,u)}function o(e,t,n,i,s,o,u){return r(t^n^i,e,t,s,o,u)}function u(e,t,n,i,s,o,u){return r(n^(t|~i),e,t,s,o,u)}function a(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var r,a,f,l,c,h=1732584193,p=-271733879,d=-1732584194,v=271733878;for(r=0;r<e.length;r+=16)a=h,f=p,l=d,c=v,h=i(h,p,d,v,e[r],7,-680876936),v=i(v,h,p,d,e[r+1],12,-389564586),d=i(d,v,h,p,e[r+2],17,606105819),p=i(p,d,v,h,e[r+3],22,-1044525330),h=i(h,p,d,v,e[r+4],7,-176418897),v=i(v,h,p,d,e[r+5],12,1200080426),d=i(d,v,h,p,e[r+6],17,-1473231341),p=i(p,d,v,h,e[r+7],22,-45705983),h=i(h,p,d,v,e[r+8],7,1770035416),v=i(v,h,p,d,e[r+9],12,-1958414417),d=i(d,v,h,p,e[r+10],17,-42063),p=i(p,d,v,h,e[r+11],22,-1990404162),h=i(h,p,d,v,e[r+12],7,1804603682),v=i(v,h,p,d,e[r+13],12,-40341101),d=i(d,v,h,p,e[r+14],17,-1502002290),p=i(p,d,v,h,e[r+15],22,1236535329),h=s(h,p,d,v,e[r+1],5,-165796510),v=s(v,h,p,d,e[r+6],9,-1069501632),d=s(d,v,h,p,e[r+11],14,643717713),p=s(p,d,v,h,e[r],20,-373897302),h=s(h,p,d,v,e[r+5],5,-701558691),v=s(v,h,p,d,e[r+10],9,38016083),d=s(d,v,h,p,e[r+15],14,-660478335),p=s(p,d,v,h,e[r+4],20,-405537848),h=s(h,p,d,v,e[r+9],5,568446438),v=s(v,h,p,d,e[r+14],9,-1019803690),d=s(d,v,h,p,e[r+3],14,-187363961),p=s(p,d,v,h,e[r+8],20,1163531501),h=s(h,p,d,v,e[r+13],5,-1444681467),v=s(v,h,p,d,e[r+2],9,-51403784),d=s(d,v,h,p,e[r+7],14,1735328473),p=s(p,d,v,h,e[r+12],20,-1926607734),h=o(h,p,d,v,e[r+5],4,-378558),v=o(v,h,p,d,e[r+8],11,-2022574463),d=o(d,v,h,p,e[r+11],16,1839030562),p=o(p,d,v,h,e[r+14],23,-35309556),h=o(h,p,d,v,e[r+1],4,-1530992060),v=o(v,h,p,d,e[r+4],11,1272893353),d=o(d,v,h,p,e[r+7],16,-155497632),p=o(p,d,v,h,e[r+10],23,-1094730640),h=o(h,p,d,v,e[r+13],4,681279174),v=o(v,h,p,d,e[r],11,-358537222),d=o(d,v,h,p,e[r+3],16,-722521979),p=o(p,d,v,h,e[r+6],23,76029189),h=o(h,p,d,v,e[r+9],4,-640364487),v=o(v,h,p,d,e[r+12],11,-421815835),d=o(d,v,h,p,e[r+15],16,530742520),p=o(p,d,v,h,e[r+2],23,-995338651),h=u(h,p,d,v,e[r],6,-198630844),v=u(v,h,p,d,e[r+7],10,1126891415),d=u(d,v,h,p,e[r+14],15,-1416354905),p=u(p,d,v,h,e[r+5],21,-57434055),h=u(h,p,d,v,e[r+12],6,1700485571),v=u(v,h,p,d,e[r+3],10,-1894986606),d=u(d,v,h,p,e[r+10],15,-1051523),p=u(p,d,v,h,e[r+1],21,-2054922799),h=u(h,p,d,v,e[r+8],6,1873313359),v=u(v,h,p,d,e[r+15],10,-30611744),d=u(d,v,h,p,e[r+6],15,-1560198380),p=u(p,d,v,h,e[r+13],21,1309151649),h=u(h,p,d,v,e[r+4],6,-145523070),v=u(v,h,p,d,e[r+11],10,-1120210379),d=u(d,v,h,p,e[r+2],15,718787259),p=u(p,d,v,h,e[r+9],21,-343485551),h=t(h,a),p=t(p,f),d=t(d,l),v=t(v,c);return[h,p,d,v]}function f(e){var t,n="";for(t=0;t<e.length*32;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function l(e){var t,n=[];n[(e.length>>2)-1]=undefined;for(t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<e.length*8;t+=8)n[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32;return n}function c(e){return f(a(l(e),e.length*8))}function h(e,t){var n,r=l(e),i=[],s=[],o;i[15]=s[15]=undefined,r.length>16&&(r=a(r,e.length*8));for(n=0;n<16;n+=1)i[n]=r[n]^909522486,s[n]=r[n]^1549556828;return o=a(i.concat(l(t)),512+t.length*8),f(a(s.concat(o),640))}function p(e){var t="0123456789abcdef",n="",r,i;for(i=0;i<e.length;i+=1)r=e.charCodeAt(i),n+=t.charAt(r>>>4&15)+t.charAt(r&15);return n}function d(e){return unescape(encodeURIComponent(e))}function v(e){return c(d(e))}function m(e){return p(v(e))}function g(e,t){return h(d(e),d(t))}function y(e,t){return p(g(e,t))}function b(e,t,n){return t?n?g(t,e):y(t,e):n?v(e):m(e)}typeof define=="function"&&define.amd?define("lib/md5",[],function(){return b}):e.md5=b})(this),define("app/dialog",[],function(){var e=function(){var e={init:function(e){this.initWrapper(e),this.initEvents()},initWrapper:function(e){this.$wrap=$("#pro_confirm_box"),this.$icon=this.$wrap.find("div.modal-body>i"),this.$content=this.$wrap.find("div.modal-body>span");if(e==="confirm"){var t=['<a href="javascript:" class="btn btn-blue">确定</a>','<a href="javascript:" class="btn">取消</a>'].join("");this.$wrap.find("div.modal-footer").html(t),this.$comfirm=this.$wrap.find("div.modal-footer>a:first"),this.$cancel=this.$wrap.find("div.modal-footer>a:last")}if(e==="alert"){var t='<a href="javascript:" class="btn btn-blue">确定</a>';this.$wrap.find("div.modal-footer").html(t),this.$comfirm=this.$wrap.find("div.modal-footer>a:first")}},judgePosition:function(){var e=$(document).scrollTop()>0?$(document).scrollTop()/2:0;this.$wrap.css({top:$(window).height()/2+this.$wrap.height()/4+e,left:$(window).width()/2-this.$wrap.width()/2})},initEvents:function(){var e=this;$(window).on("click",function(t){e.$content.empty(),e.$wrap.hide()}),$("div#pro_confirm_box").on("click",function(e){e.stopPropagation()}),$(window).resize(function(){e.judgePosition()})},_confirm:function(e,t){var n=this;this.init("confirm"),this.$wrap.show(),this.judgePosition(),this.$content.html(e),this.$comfirm.on("click",function(e){t&&t(),n.$content.empty(),n.$wrap.hide()}),this.$cancel.on("click",function(e){n.$content.empty(),n.$wrap.hide()})},_alert:function(e,t){var n=this;this.init("alert"),this.$wrap.show(),this.judgePosition(),this.$content.html(e),this.$comfirm.on("click",function(e){t&&t(),n.$content.empty(),n.$wrap.hide()})}};return{confirm:function(t,n){return e._confirm(t,n)},alert:function(t,n){return e._alert(t,n)}}}();return{confirm:function(t,n){return e.confirm(t,n)},alert:function(t,n){return e.alert(t,n)}}}),function(e,t,n){function f(e){var t={},r=/^jQuery\d+$/;return n.each(e.attributes,function(e,n){n.specified&&!r.test(n.name)&&(t[n.name]=n.value)}),t}function l(e,r){var i=this,s=n(i);if((i.value==s.prop("placeholder")||i.value==s.attr("placeholder"))&&s.hasClass("placeholder"))if(s.data("placeholder-password")){s=s.hide().next().show().attr("id",s.removeAttr("id").data("placeholder-id"));if(e===!0)return s[0].value=r;s.focus()}else i.value="",s.removeClass("placeholder"),i==t.activeElement&&i.select()}function c(){var e,t=this,r=n(t),i=r,s=this.id;if(t.value==""){if(t.type=="password"){if(!r.data("placeholder-textinput")){try{e=r.clone().attr({type:"text"})}catch(o){e=n("<input>").prop(n.extend(f(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":s}).bind("focus.placeholder",l),r.data({"placeholder-textinput":e,"placeholder-id":s}).before(e)}r=r.removeAttr("id").hide().prev().attr("id",s).show()}r.addClass("placeholder"),r[0].value=r.prop("placeholder")||r.attr("placeholder")}else r.removeClass("placeholder")}var r="placeholder"in t.createElement("input"),i="placeholder"in t.createElement("textarea"),s=n.fn,o=n.valHooks,u,a;r&&i?(a=s.placeholder=function(){return this},a.input=a.textarea=!0):(a=s.placeholder=function(){var e=this;return e.filter((r?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":l,"blur.placeholder":c}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},a.input=r,a.textarea=i,u={get:function(e){var t=n(e);return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,r){var i=n(e);return i.data("placeholder-enabled")?(r==""?(e.value=r,e!=t.activeElement&&c.call(e)):i.hasClass("placeholder")?l.call(e,!0,r)||(e.value=r):e.value=r,i):e.value=r}},r||(o.input=u),i||(o.textarea=u),n(function(){n(t).delegate("form","submit.placeholder",function(){var e=n(".placeholder",this).each(l);setTimeout(function(){e.each(c)},10)})}),n(e).bind("beforeunload.placeholder",function(){n(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery),define("lib/placeholder",function(){}),function(e){if(e.Base64)return;var t="2.1.2",n;typeof module!="undefined"&&module.exports&&(n=require("buffer").Buffer);var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=function(e){var t={};for(var n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(r),s=String.fromCharCode,o=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?s(192|t>>>6)+s(128|t&63):s(224|t>>>12&15)+s(128|t>>>6&63)+s(128|t&63)}var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return s(240|t>>>18&7)+s(128|t>>>12&63)+s(128|t>>>6&63)+s(128|t&63)},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,a=function(e){return e.replace(u,o)},f=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),i=[r.charAt(n>>>18),r.charAt(n>>>12&63),t>=2?"=":r.charAt(n>>>6&63),t>=1?"=":r.charAt(n&63)];return i.join("")},l=e.btoa||function(e){return e.replace(/[\s\S]{1,3}/g,f)},c=n?function(e){return(new n(e)).toString("base64")}:function(e){return l(a(e))},h=function(e,t){return t?c(e).replace(/[+\/]/g,function(e){return e=="+"?"-":"_"}).replace(/=/g,""):c(e)},p=function(e){return h(e,!0)},d=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),v=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return s((n>>>10)+55296)+s((n&1023)+56320);case 3:return s((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return s((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},m=function(e){return e.replace(d,v)},g=function(e){var t=e.length,n=t%4,r=(t>0?i[e.charAt(0)]<<18:0)|(t>1?i[e.charAt(1)]<<12:0)|(t>2?i[e.charAt(2)]<<6:0)|(t>3?i[e.charAt(3)]:0),o=[s(r>>>16),s(r>>>8&255),s(r&255)];return o.length-=[0,0,2,1][n],o.join("")},y=e.atob||function(e){return e.replace(/[\s\S]{1,4}/g,g)},b=n?function(e){return(new n(e,"base64")).toString()}:function(e){return m(y(e))},w=function(e){return b(e.replace(/[-_]/g,function(e){return e=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};e.Base64={VERSION:t,atob:y,btoa:l,fromBase64:w,toBase64:h,utob:a,encode:h,encodeURI:p,btou:m,decode:w};if(typeof Object.defineProperty=="function"){var E=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};e.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",E(function(){return w(this)})),Object.defineProperty(String.prototype,"toBase64",E(function(e){return h(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",E(function(){return h(this,!0)}))}}}(this),define("lib/base64",function(){}),function(e){typeof define=="function"&&define.amd?define("lib/jquery/jquery.ui.widget",[],e):e(jQuery)}(function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a={},f=t.split(".")[0];t=t.split(".")[1],i=f+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[f]=e[f]||{},s=e[f][t],o=e[f][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){if(!e.isFunction(r)){a[t]=r;return}a[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},a,{constructor:o,namespace:f,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}),function(e){typeof define=="function"&&define.amd?define("lib/fileupload",["lib/jquery/jquery.ui.widget"],e):e(window.jQuery)}(function(e){e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))")).test(window.navigator.userAgent)&&!e('<input type="file">').prop("disabled"),e.support.xhrFileUpload=!!window.XMLHttpRequestUpload&&!!window.FileReader,e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:undefined,replaceFileInput:!0,paramName:undefined,singleFileUploads:!0,limitMultiFileUploads:undefined,sequentialUploads:!1,limitConcurrentUploads:undefined,forceIframeTransport:!1,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:!0,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,n){return t=this.messages[t]||t.toString(),n&&e.each(n,function(e,n){t=t.replace("{"+e+"}",n)}),t},formData:function(e){return e.serializeArray()},add:function(t,n){(n.autoUpload||n.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&n.process().done(function(){n.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var r=e-this.timestamp;if(!this.bitrate||!n||r>n)this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=e;return this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;return typeof t.formData=="function"?t.formData(t.form):e.isArray(t.formData)?t.formData:e.type(t.formData)==="object"?(n=[],e.each(t.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(t){var n=0;return e.each(t,function(e,t){n+=t.size||1}),n},_initProgressObject:function(t){var n={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,n):t._progress=n},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(e,t){if(e.lengthComputable){var n=Date.now?Date.now():(new Date).getTime(),r;if(t._time&&t.progressInterval&&n-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=n,r=Math.floor(e.loaded/e.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0),this._progress.loaded+=r-t._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,t.bitrateInterval),t._progress.loaded=t.loaded=r,t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(n,r,t.bitrateInterval),this._trigger("progress",e,t),this._trigger("progressall",e,this._progress)}},_initProgressListener:function(t){var n=this,r=t.xhr?t.xhr():e.ajaxSettings.xhr();r.upload&&(e(r.upload).bind("progress",function(e){var r=e.originalEvent;e.lengthComputable=r.lengthComputable,e.loaded=r.loaded,e.total=r.total,n._onProgress(e,t)}),t.xhr=function(){return r})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var n=this,r,i=t.files[0],s=t.multipart||!e.support.xhrFileUpload,o=t.paramName[0];t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange);if(!s||t.blob||!this._isInstanceOf("File",i))t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.name)+'"';s?e.support.xhrFormDataFileUpload&&(t.postMessage?(r=this._getFormData(t),t.blob?r.push({name:o,value:t.blob}):e.each(t.files,function(e,n){r.push({name:t.paramName[e]||o,value:n})})):(n._isInstanceOf("FormData",t.formData)?r=t.formData:(r=new FormData,e.each(this._getFormData(t),function(e,t){r.append(t.name,t.value)})),t.blob?r.append(o,t.blob,i.name):e.each(t.files,function(e,i){(n._isInstanceOf("File",i)||n._isInstanceOf("Blob",i))&&r.append(t.paramName[e]||o,i,i.name)})),t.data=r):(t.contentType=i.type,t.data=t.blob||i),t.blob=null},_initIframeSettings:function(t){var n=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&n&&n!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var n=e(t.fileInput),r=t.paramName;return r?e.isArray(r)||(r=[r]):(r=[],n.each(function(){var t=e(this),n=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;while(i)r.push(n),i-=1}),r.length||(r=[n.prop("name")||"files[]"])),r},_initFormSettings:function(t){if(!t.form||!t.form.length)t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")));t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||e.type(t.form.prop("method"))==="string"&&t.form.prop("method")||"").toUpperCase(),t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);return this._initFormSettings(n),this._initDataSettings(n),n},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,n,r){var i=e.Deferred(),s=i.promise();return n=n||this.options.context||s,t===!0?i.resolveWith(n,r):t===!1&&i.rejectWith(n,r),s.abort=i.promise,this._enhancePromise(s)},_addConvenienceMethods:function(t,n){var r=this,i=function(t){return e.Deferred().resolveWith(r,[t]).promise()};n.process=function(e,t){if(e||t)n._processQueue=this._processQueue=(this._processQueue||i(this)).pipe(e,t);return this._processQueue||i(this)},n.submit=function(){return this.state()!=="pending"&&(n.jqXHR=this.jqXHR=r._trigger("submit",t,this)!==!1&&r._onSend(t,this)),this.jqXHR||r._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():r._getXHRPromise()},n.state=function(){if(this.jqXHR)return r._getDeferredState(this.jqXHR);if(this._processQueue)return r._getDeferredState(this._processQueue)},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),r=n&&n.length>1&&parseInt(n[1],10);return r&&r+1},_chunkedUpload:function(t,n){t.uploadedBytes=t.uploadedBytes||0;var r=this,i=t.files[0],s=i.size,o=t.uploadedBytes,u=t.maxChunkSize||s,a=this._blobSlice,f=e.Deferred(),l=f.promise(),c,h;return!(this._isXHRUpload(t)&&a&&(o||u<s))||t.data?!1:n?!0:o>=s?(i.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",i.error])):(h=function(){var n=e.extend({},t),l=n._progress.loaded;n.blob=a.call(i,o,o+u,i.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+o+"-"+(o+n.chunkSize-1)+"/"+s,r._initXHRData(n),r._initProgressListener(n),c=(r._trigger("chunksend",null,n)!==!1&&e.ajax(n)||r._getXHRPromise(!1,n.context)).done(function(i,u,a){o=r._getUploadedBytes(a)||o+n.chunkSize,l+n.chunkSize-n._progress.loaded&&r._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o-n.uploadedBytes,total:o-n.uploadedBytes}),n),t.uploadedBytes=n.uploadedBytes=o,n.result=i,n.textStatus=u,n.jqXHR=a,r._trigger("chunkdone",null,n),r._trigger("chunkalways",null,n),o<s?h():f.resolveWith(n.context,[i,u,a])}).fail(function(e,t,i){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,r._trigger("chunkfail",null,n),r._trigger("chunkalways",null,n),f.rejectWith(n.context,[e,t,i])})},this._enhancePromise(l),l.abort=function(){return c.abort()},h(),l)},_beforeSend:function(e,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,n,r,i){var s=i._progress.total,o=i._response;i._progress.loaded<s&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:s,total:s}),i),o.result=i.result=t,o.textStatus=i.textStatus=n,o.jqXHR=i.jqXHR=r,this._trigger("done",null,i)},_onFail:function(e,t,n,r){var i=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),i.jqXHR=r.jqXHR=e,i.textStatus=r.textStatus=t,i.errorThrown=r.errorThrown=n,this._trigger("fail",null,r)},_onAlways:function(e,t,n,r){this._trigger("always",null,r)},_onSend:function(t,n){n.submit||this._addConvenienceMethods(t,n);var r=this,i,s,o,u,a=r._getAJAXSettings(n),f=function(){return r._sending+=1,a._bitrateTimer=new r._BitrateTimer,i=i||((s||r._trigger("send",t,a)===!1)&&r._getXHRPromise(!1,a.context,s)||r._chunkedUpload(a)||e.ajax(a)).done(function(e,t,n){r._onDone(e,t,n,a)}).fail(function(e,t,n){r._onFail(e,t,n,a)}).always(function(e,t,n){r._onAlways(e,t,n,a),r._sending-=1,r._active-=1;if(a.limitConcurrentUploads&&a.limitConcurrentUploads>r._sending){var i=r._slots.shift();while(i){if(r._getDeferredState(i)==="pending"){i.resolve();break}i=r._slots.shift()}}r._active===0&&r._trigger("stop")}),i};return this._beforeSend(t,a),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),u=o.pipe(f)):(this._sequence=this._sequence.pipe(f,f),u=this._sequence),u.abort=function(){return s=[undefined,"abort","abort"],i?i.abort():(o&&o.rejectWith(a.context,s),f())},this._enhancePromise(u)):f()},_onAdd:function(t,n){var r=this,i=!0,s=e.extend({},this.options,n),o=s.limitMultiFileUploads,u=this._getParamName(s),a,f,l,c;if(!s.singleFileUploads&&!o||!this._isXHRUpload(s))l=[n.files],a=[u];else if(!s.singleFileUploads&&o){l=[],a=[];for(c=0;c<n.files.length;c+=o)l.push(n.files.slice(c,c+o)),f=u.slice(c,c+o),f.length||(f=u),a.push(f)}else a=u;return n.originalFiles=n.files,e.each(l||n.files,function(s,o){var u=e.extend({},n);return u.files=l?o:[o],u.paramName=a[s],r._initResponseObject(u),r._initProgressObject(u),r._addConvenienceMethods(t,u),i=r._trigger("add",t,u),i}),i},_replaceFileInput:function(t){var n=t.clone(!0);e("<form></form>").append(n)[0].reset(),t.after(n).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,r){return r===t[0]?n[0]:r}),t[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,n){var r=this,i=e.Deferred(),s=function(e){e&&!e.entry&&(e.entry=t),i.resolve([e])},o;return n=n||"",t.isFile?t._file?(t._file.relativePath=n,i.resolve(t._file)):t.file(function(e){e.relativePath=n,i.resolve(e)},s):t.isDirectory?(o=t.createReader(),o.readEntries(function(e){r._handleFileTreeEntries(e,n+t.name+"/").done(function(e){i.resolve(e)}).fail(s)},s)):i.resolve([]),i.promise()},_handleFileTreeEntries:function(t,n){var r=this;return e.when.apply(e,e.map(t,function(e){return r._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var n=t.items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(e.map(n,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var n=t.prop("webkitEntries")||t.prop("entries"),r,i;if(n&&n.length)return this._handleFileTreeEntries(n);r=e.makeArray(t.prop("files"));if(!r.length){i=t.prop("value");if(!i)return e.Deferred().resolve([]).promise();r=[{name:i.replace(/^.*\\/,"")}]}else r[0].name===undefined&&r[0].fileName&&e.each(r,function(e,t){t.name=t.fileName,t.size=t.fileSize});return e.Deferred().resolve(r).promise()},_getFileInputFiles:function(t){return t instanceof e&&t.length!==1?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var n=this,r={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(r.fileInput).always(function(e){r.files=e,n.options.replaceFileInput&&n._replaceFileInput(r.fileInput),n._trigger("change",t,r)!==!1&&n._onAdd(t,r)})},_onPaste:function(t){var n=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};n&&n.length&&(e.each(n,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&r.files.push(n)}),this._trigger("paste",t,r)!==!1&&this._onAdd(t,r))},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var t=this,n=e.dataTransfer,r={};n&&n.files&&n.files.length&&(e.preventDefault(),this._getDroppedFiles(n).always(function(n){r.files=n,t._trigger("drop",e,r)!==!1&&t._onAdd(e,r)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=t.dataTransfer,r={dropEffect:"copy",preventDefault:!0};n&&e.inArray("Files",n.types)!==-1&&this._trigger("dragover",t,r)!==!1&&(n.dropEffect=r.dropEffect,r.preventDefault&&t.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,n){var r=e.inArray(t,this._specialOptions)!==-1;r&&this._destroyEventHandlers(),this._super(t,n),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===undefined?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),n=t.pop();return t.shift(),new RegExp(t.join("/"),n)},_isRegExpOption:function(t,n){return t!=="url"&&e.type(n)==="string"&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var t=this,n=this.options;e.each(e(this.element[0].cloneNode(!1)).data(),function(e,r){t._isRegExpOption(e,r)&&(r=t._getRegExp(r)),n[e]=r})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var n=this;if(!t||this.options.disabled)return;t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n=this,r=e.Deferred(),i=r.promise(),s,o;return i.abort=function(){return o=!0,s?s.abort():(r.reject(null,"abort","abort"),i)},this._getFileInputFiles(t.fileInput).always(function(e){if(o)return;if(!e.length){r.reject();return}t.files=e,s=n._onSend(null,t).then(function(e,t,n){r.resolve(e,t,n)},function(e,t,n){r.reject(e,t,n)})}),this._enhancePromise(i)}t.files=e.makeArray(t.files);if(t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),define("app/profile",["lib/md5","app/dialog","lib/placeholder","lib/base64","lib/fileupload"],function(e,t,n){function i(){}var r=window.splus&&splus.client_id||1044;return i.prototype={sogouBaseurl:"//account.sogou.com",interfaces:{updateNickName:"/web/userinfo/updatenickname",checkSname:"/a/sogou/check/sname/",checkNickName:"/web/userinfo/checknickname?nickname=",sendEmail:"/web/security/sendemail",sendSms:"/web/security/sendsmsnew",bindMobile:"/web/security/bindmobile",updatePwd:"/web/security/updatepwd",updateAvatar:"/web/userinfo/uploadavatar"},init:function(){this.initPageEvent(),this.initBasicProfile(),window.isSohuAccount||(this.initAccountSecure(),window.isUpdatepwdUsable?this.initUpdatePassword():$(".pwd").prop("disabled",!0).css("background-color","#ccc"),this.initAccountBind()),this.initHeadPortrait()},initPageEvent:function(){$("input[type='password']").on("paste",function(e){return!1})},initBasicProfile:function(){var e=this,t=$("#pro_sname"),n=t.next("p"),r=$("#pro_nick"),i=r.next("p"),s=t.parents("div.control-group").siblings("div.state-wrapper"),o=splus?splus.accesstoken?splus.accesstoken:"":"";$("#pro_btn_basic").on("click",function(u){u.preventDefault();if(r.val()==r.attr("pro_default"))return;var a=e.checkNick(r,i,e.validObj.nick);if(!a)return!1;$.when(a).then(function(){var u=e.validObj.nick.legal;if(!u)return!1;var a=e.sogouBaseurl+e.interfaces.updateNickName;$.ajax({url:a,data:{nickname:r.val(),sname:t.val(),accesstoken:o},type:"post",dataType:"json"}).done(function(e){if(typeof e=="string"||e&&e.constructor==String)e=$.parseJSON(e);var o=+e.status;o==0&&s.fadeIn("fast",function(){setTimeout(function(){s.fadeOut(500,function(){t.removeClass("error").attr("disabled","disabled"),n.empty().hide(),r.removeClass("error").attr("pro_default",r.val()),i.empty().hide(),$(".sidebar>.uesr-name").html(r.val());try{window.external.passport("onProfileChange")}catch(e){console.log("your browser do not support the method onProfileChange,please user a high version ")}})},1200)})})})})},checkSname:function(e,t,n){var r=this;return r.check(e,t,n)?e.val()==e.attr("pro_default")?!0:$.ajax({url:r.sogouBaseurl+r.interfaces.checkSname+e.val(),type:"get",dataType:"json"}).done(function(r){r.code!==0&&(e.addClass("error"),t.show().html("该帐号太受欢迎，已有人抢注了"),n.legal=!1),r.code===0&&(e.removeClass("error"),t.empty().hide(),n.legal=!0)}):!1},checkNick:function(e,t,n){var r=this,i=encodeURIComponent(e.val());return r.check(e,t,n)?$.ajax({url:r.sogouBaseurl+r.interfaces.checkNickName+i,type:"get",dataType:"json"}).done(function(r){if(typeof r=="string"||r&&r.constructor==String)r=$.parseJSON(r);var i=+r.status;i!==0?(e.addClass("error"),t.show().html("该用户名不可用"),n.legal=!1):(e.removeClass("error"),t.empty().hide(),n.legal=!0)}):!1},initAccountSecure:function(){var e=this,t=$("#pro_phone"),n=t.siblings("p"),r=$("#pro_email"),i=r.siblings("p"),s=t.next("div"),o=r.next("div"),u=splus?splus.accesstoken?splus.accesstoken:"":"";window.isBindMobileUsable?e.bindPhone():t.prop("disabled",!0).css("background-color","#ccc"),window.isBindEmailUsable?e.bindEmail():r.prop("disabled",!0).css("background-color","#ccc")},bindEmail:function(){var e=this,t=$("#pro_email_area_1"),n=$("#pro_email_area_2"),i=$("#pro_email_area_3"),s=i.find("input"),o=s.siblings("p"),u=splus?splus.accesstoken?splus.accesstoken:"":"",a=splus?splus.instanceid?splus.instanceid:"":"",f=$("#pro_email_pwd_area"),l=$("#pro_email_pwd"),c=l.siblings("p"),h=f.find("div.btn-wrap>a:first"),p=f.find("div.btn-wrap>a:last");t.on("click","div>a",function(e){i.show(),t.hide()}),n.on("click","a#pre_btn_back",function(e){n.hide(),i.show()}).on("click","a#pre_btn_retry",function(t){var n=e.sogouBaseurl+e.interfaces.sendEmail,r=$(t.target),i=r.attr("pro_default");$.post(e.interfaces.sendEmail,{email:i,accesstoken:u,instanceid:a})}),i.on("click","div>a",function(){var t=e.checkEmail(s,o,e.validObj.email);t&&f.show()}),p.click(function(){f.hide()}),h.on("click",function(t){var a=e.checkEmail(s,o,e.validObj.email),h=e.check(l,c,e.validObj.password),p=e.sogouBaseurl+e.interfaces.sendEmail;a&&h&&$.ajax({url:p,type:"post",dataType:"json",data:{new_email:s.val(),accesstoken:u,client_id:r,password:l.val(),ru:window.location.href}}).done(function(e){if(typeof e=="string"||e&&e.constructor==String)e=$.parseJSON(e);var t={10001:" 未知错误 ",10002:"参数错误,请输入必填的参数或参数验证失败",20229:"账号未登录，请先登录 ",20243:"SOHU域用户不允许此操作",20244:"第三方账号不允许此操作",20295:"今日绑定次数超限，请明日再试",20210:"今日密码验证失败次数超过上限",20223:"当日邮件发送次数已达上限",20285:"旧绑定邮箱错误",20206:"用户名或密码不正确",20284:"申请邮件发送失败"},r=e.status;switch(!0){case"0"==r:$("p:first",n).html("确认邮件已发送到邮箱："+s.val()),$("a#pre_btn_retry",n).attr("pro_default",s.val()),i.hide(),n.show(),f.hide();break;case/20229|20210|20206/.test(r):l.addClass("error"),c.html(t[r]||e.statusText||"未知错误").addClass("red").show();break;default:s.addClass("error"),o.html(t[r]||e.statusText||"未知错误").addClass("red").show()}})})},checkEmail:function(e,t,n){var r=this;return r.check(e,t,n)?(t.removeClass("red"),!0):(n.legal=!1,t.addClass("red"),!1)},countdown:function(e){var t=this,n=60,r;r=setInterval(function(){n===0?(e.empty().html('<a href="javascript:">获取验证码</a>'),clearInterval(r)):e.empty().html('<span style="height:25px;line-height:25px"><span style="color:#000093;font-size:12px">&nbsp;'+n-- +"</span> 秒后重新获取验证码</span>")},1e3)},bindPhone:function(){var e=this,t=$("#pro_phone"),n=t.siblings("p"),i=t.next("div"),s=$("#pro_vcode_area"),o=$("#pro_vcode_pwd_area"),u=$("#pro_vcode"),a=$("#pro_pwd"),f=u.siblings("p"),l=a.siblings("p"),c=s.find("div.btn-wrap>a:first"),h=s.find("div.btn-wrap>a:last"),p=s.find("div.code"),d=splus?splus.accesstoken?splus.accesstoken:"":"";i.on("click",function(r){var i=e.checkPhone(t,n,e.validObj.phone);i&&(s.show(),o.show())}),$("fieldset.bind").on("click","div.code>a",function(n){n.stopPropagation();var i=e.sogouBaseurl+e.interfaces.sendSms;$.ajax({url:i,data:{smstype:1,client_id:r,new_mobile:t.val()},type:"get",dataType:"json"}).done(function(t){if(typeof t=="string"||t&&t.constructor==String)t=$.parseJSON(t);var n=+t.status;switch(n){case 0:e.countdown(p),f.html("手机可以用来找回密码以及登陆").removeClass("red");break;case 10002:f.html("参数错误").show().addClass("red");break;case 20229:f.html("账号未登录，请先登录").show().addClass("red");break;case 20243:f.html("SOHU域用户不允许此操作").show().addClass("red");break;case 20244:f.html("第三方账号不允许此操作").show().addClass("red");break;case 20225:f.html("手机号已绑定其他账号").show().addClass("red");break;case 20209:f.html("今日验证码校验错误次数已超过上限").show().addClass("red");break;case 20202:f.html("今日手机短信发送次数超过上限").show().addClass("red");break;case 20204:f.html("一分钟内只能发一条短信").show().addClass("red");break;case 20213:f.html("手机验证码发送失败").show().addClass("red");break;default:f.html("未知错误").show().addClass("red")}})}),h.on("click",function(e){t.val(""),u.val(""),s.hide(),f.empty().removeClass("red").hide(),n.empty().hide()}),c.on("click",function(i){var s=e.checkPhone(t,n,e.validObj.phone),o=e.check(u,f,e.validObj.vcode),c=e.check(a,l,e.validObj.password);if(!o){f.addClass("red");return}f.removeClass("red");if(!c){l.addClass("red");return}l.removeClass("red");if(s&&c){var h=e.sogouBaseurl+e.interfaces.bindMobile;$.ajax({url:h,data:{new_mobile:t.val(),smscode:u.val(),client_id:r,password:a.val(),accesstoken:d},dataType:"json",type:"post"}).done(function(e){var r={10001:" 未知错误  ",10002:" 参数错误,请输入必填的参数或参数验证失败 ",20208:"新手机验证码错误或已过期",20229:"账号未登录，请先登录 ",20243:" SOHU域用户不允许此操作",20244:" 第三方账号不允许此操作",20245:" 手机账号不允许此操作",20295:" 今日绑定次数超限，请明日再试",20210:" 今日密码验证失败次数超过上限",20206:" 用户名或密码不正确",20225:" 手机号已绑定其他账号",20209:" 今日验证码校验错误次数已超过上限",20216:" 验证码错误或已过期",20289:" 绑定手机失败"};if(typeof e=="string"||e&&e.constructor==String)e=$.parseJSON(e)||{};var i=e.status;switch(!0){case i=="0":window.location.reload();break;case/(20210|20206)/.test(i):a.addClass("error"),l.addClass("red").html(r[i]).show();break;case/(20209|20216)/.test(i):u.addClass("error"),f.addClass("red").html(r[i]).show();break;default:t.addClass("error"),n.addClass("red").html(r[i]||"未知错误").show()}})}})},checkPhone:function(e,t,n){var r=this;return r.check(e,t,n)?(t.removeClass("red"),!0):(t.addClass("red"),n.legal=!1,!1)},initUpdatePassword:function(){var e=this,t=$("#pro_ori_pass"),n=$("#pro_new_pass"),i=$("#pro_con_pass"),s=$("#pro_btn_pass"),o=t.parents("div.control-group").siblings("div.state-wrapper"),u=splus?splus.accesstoken?splus.accesstoken:"":"",a=e.validObj.password;n.on("blur",function(t){e.check($(this),$(this).next("p"),a)||$(this).next("p").show().addClass("red")}),i.on("blur",function(t){if($(this).val()!=n.val()){$(this).next("p").text("密码不一致").show().addClass("red");return}e.check($(thisArea),$(this).next("p"),a)||$(this).next("p").show().addClass("red")}),s.on("click",function(s){s.preventDefault(),e.checkPassword(t,n,i,a),a.legal&&$.ajax({url:e.sogouBaseurl+e.interfaces.updatePwd,type:"post",dataType:"json",data:{password:t.val(),newpwd:n.val(),client_id:r,accesstoken:u}}).done(function(e){if(typeof e=="string"||e&&e.constructor==String)e=$.parseJSON(e);var r=e.status,s={10001:"未知错误 ",10002:"参数错误,请输入必填的参数或参数验证失败  ",10009:"账号不存在或异常 ",10010:"client_id不存在",20198:"当日用户原密码校验错误次数已达上限 ",20205:"帐号不存在 ",20206:"密码错误 ",20218:"重置密码失败 ",20221:"验证码验证失败 ",20222:"当日修改或重置密码次数已达上限 ",20230:"登陆用户或者ip在黑名单中 ",20244:"第三方账号不允许此操作 "};switch(!0){case"0"==r:o.fadeIn("fast",function(){setTimeout(function(){o.fadeOut(500)},1200)}),t.val("").removeClass("error"),n.val("").removeClass("error"),i.val("").removeClass("error"),t.next("p").empty().hide(),n.next("p").empty().hide(),i.next("p").empty().hide();break;case/20206/.test(r):t.next("p").html(s[r]||"未知错误").show().addClass("red");break;default:i.next("p").html(s[r]||"未知错误").show().addClass("red")}})})},checkPassword:function(e,t,n,r){var i=this,s=e.next("p"),o=t.next("p"),u=n.next("p"),a=$.extend({},r,{emptyMsg:"请填写密码"}),f=$.extend({},r,{emptyMsg:"请填写新密码"}),l=$.extend({},r,{emptyMsg:"请填写确认密码"});return i.check(e,s,a)?i.check(t,o,f)?i.check(n,u,l)?t.val()!==n.val()?(n.addClass("error"),u.html("两次密码输入不一致，请重新填写").show(),r.legal=!1,!1):(t.removeClass("error"),u.empty().hide(),r.legal=!0,!0):(r.legal=!1,!1):(r.legal=!1,!1):(r.legal=!1,!1)},initAccountBind:function(){var e=this,n=$("#pro_bind_list>ul>li"),r=splus?splus.accesstoken?splus.accesstoken:"":"";n.each(function(n,i){var s=$(i),o=s.find("a");if(o.hasClass("unbind-btn")){var u=o.attr("identify");o.on("click",function(n){n.stopPropagation();var i=$(this).attr("identify"),s="解除绑定后,将不能用该帐号进行登录,该帐号的信息也将消失,是否确定解除绑定?";t.confirm(s,function(){$.ajax({url:e.sogouBaseurl+"/a/sogou/bind/remove/"+i,data:{accesstoken:r},dataType:"json",type:"post"}).done(function(e){if(e.code==0){o.removeClass("unbind-btn");var n=window.location.href;window.location.href=n}else e.code==2?t.alert("当前帐号只绑定了一个社交帐号，无法解除绑定"):e.code==1&&t.alert("解绑失败")})})})}}),splus&&splus.bind_tipmsg&&t.alert(splus.bind_tipmsg)},initHeadPortrait:function(){var e=this,t=$("#pro_file_input"),n=splus?splus.accesstoken?splus.accesstoken:"":"",i=splus?splus.avatar_token?splus.avatar_token:"":"",s=e.sogouBaseurl+e.interfaces.updateAvatar;t.fileupload({url:s,dataType:"json",maxFileSize:5242880,contentType:!1,formData:{client_id:r},acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,done:function(e,t){t=t.result;if(typeof t=="string"||t&&t.constructor==String)t=$.parseJSON(t)||{};var n=t.status;if(0==n){$("aside.sidebar div.photo-error").empty().hide(),$("aside.sidebar div.uesr-photo").removeClass("uesr-photo-error");try{window.external.passport("onProfileChange")}catch(e){console.log("your browser do not support the method onProfileChange,please user a high version ")}window.location.reload()}else $("aside.sidebar div.photo-error").html("上传头像失败,仅支持小于3M的jpg、gif、png图片文件").show(),$("aside.sidebar div.uesr-photo").addClass("uesr-photo-error")}})},isSimple:function(e,t,n){var r=this,i=!0,s=["123456","12345678","qwerty","qwaszx","qazwsx","password","abc123"];return $.each(s,function(s,o){if(e.val()==o)return t.show().html(n),e.addClass("error").one("blur",function(i){r.isSimple(e,t,n)}).one("focus",function(n){e.removeClass("error"),t.empty().hide()}),i=!1,!1}),i&&(e.removeClass("error"),t.empty().hide()),i},check:function(e,t,n){var r=this,i=n.nullable,s=n.regStr,o=n.emptyMsg,u=n.errMsg;return!i&&e.val()==""?(e.addClass("error").one("focus",function(){t.empty().hide(),e.removeClass("error")}),e.attr("id")!="pro_phone"&&e.attr("id")!="pro_email"&&e.one("blur",function(){r.check(e,t,n)}),t.show().html(o).addClass("red"),!1):i&&e.val()==""?(e.removeClass("error"),t.empty().hide(),!0):s.test(e.val())?(e.removeClass("error"),t.empty().hide().removeClass("red;"),!0):(e.addClass("error").one("focus",function(){t.empty().hide(),e.removeClass("error")}),e.attr("id")!="pro_phone"&&e.attr("id")!="pro_email"&&e.one("blur",function(){r.check(e,t,n)}),t.show().html(u).addClass("red"),!1)},validObj:{phone:{errMsg:"请正确填写手机号",emptyMsg:"手机号不能为空",nullable:!1,regStr:/^1\d{10}$/,legal:!0},email:{errMsg:"请正确输入邮箱",emptyMsg:"请输入邮箱",nullable:!1,regStr:/^(\w)+(\.\w+)*@([\w_\-])+((\.\w+)+)$/,legal:!0},password:{errMsg:"密码位数为6-16位，仅限数字、字母和字符，字母区分大小写",emptyMsg:"请正确输入密码",nullable:!1,regStr:/^\w{6,16}$/,legal:!0},vcode:{errMsg:"请正确输入验证码",emptyMsg:"验证码不能为空",nullable:!1,regStr:/^\w*$/,legal:!0},regacc:{errMsg:"仅支持4-16位字母、数字及“-”",emptyMsg:"请填写帐号",nullable:!1,regStr:/^[a-zA-Z0-9-]{4,16}$/,legal:!0},nick:{errMsg:"用户名为2-12位中英文字符",emptyMsg:"请填写用户名",nullable:!1,regStr:/^([a-zA-Z0-9]|[\u4e00-\u9fa5]){2,12}$/,legal:!0}}},i}),require(["app/profile"],function(e){(new e).init()}),define("pages/profile",function(){})