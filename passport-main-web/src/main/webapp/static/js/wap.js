define("wap/interface",[],function(){var d=1024;var n=function(){};function e(p,o){o=o||n;return $.ajax({url:"/web/login/checkNeedCaptcha",data:{username:p,client_id:d},cache:false,dataType:"json",success:function(q){if("string"===typeof q){try{q=JSON.parse(q)}catch(r){}}if(q&&q.data&&q.data.needCaptcha){return o(true)}else{return o(false)}},error:function(){return o(false)}})}function f(o){return"/captcha?token="+o+"&_"+(+new Date())}function k(q,p){var o={client_id:d,v:0,ru:"http://wap.sogou.com"};p=p||n;$.extend(o,q);return $.ajax({url:"/wap/login",type:"post",data:o,dataType:"json",error:function(){return p(false,{statusText:"登录失败"})},success:function(r){if(r&&!+r.status){return p(true,r.data)}else{return p(false,r)}}})}function l(p,o){o=o||n;return $.ajax({url:"/web/account/checkusername",data:{username:p},dataType:"json",success:function(q){if("string"===typeof q){try{q=JSON.parse(q)}catch(r){q={status:1,statusText:"格式错误"}}}if(!!q&&!+q.status){return o(true)}else{if(!!q){return o(false,q)}}}})}function j(o,p){p=p||n;return $.ajax({url:"/web/sendsms",data:{client_id:d,mobile:o},dataType:"json",success:function(q){if("string"===typeof q){try{q=JSON.parse(q)}catch(r){q={status:1,statusText:"格式错误"}}}if(q&&!+q.status){return p(true)}else{return p(false,q)}},error:function(){return p(false,{statusText:"发送失败"})}})}function a(q,p){var o={client_id:d,v:5,ru:"http://wap.sogou.com"};p=p||n;$.extend(o,q);$.ajax({url:"/wap/findpwd/checksms",type:"post",data:o,dataType:"json",success:function(r){if("string"===typeof r){try{r=JSON.parse(r)}catch(s){r={status:1,statusText:"格式错误"}}}if(r&&!+r.status){return p(true,r.data)}else{return p(false,r)}},error:function(){return p(false,{statusText:"提交失败"})}})}function g(o,p){p=p||n;return $.ajax({url:"/wap/findpwd/sendsms",data:{client_id:d,mobile:o},dataType:"json",success:function(q){if("string"===typeof q){try{q=JSON.parse(q)}catch(r){q={status:1,statusText:"格式错误"}}}if(q&&!+q.status){return p(true)}else{return p(false,q)}},error:function(){return p(false,{statusText:"发送失败"})}})}function h(q,p){var o={client_id:d,v:5,ru:"http://wap.sogou.com"};p=p||n;$.extend(o,q);$.ajax({url:"/wap/findpwd/check",type:"post",data:o,dataType:"json",success:function(r){if("string"===typeof r){try{r=JSON.parse(r)}catch(s){r={status:1,statusText:"格式错误"}}}if(r&&!+r.status){return p(true,r.data)}else{return p(false,r)}},error:function(){return p(false,{statusText:"提交失败"})}})}function b(q,p){var o={client_id:d,v:5,ru:"http://wap.sogou.com"};p=p||n;$.extend(o,q);$.ajax({url:"/wap/findpwd/sendemail",type:"post",data:o,dataType:"json",success:function(r){if("string"===typeof r){try{r=JSON.parse(r)}catch(s){r={status:1,statusText:"格式错误"}}}if(r&&!+r.status){return p(true,r.data)}else{return p(false,r)}},error:function(){return p(false,{statusText:"提交失败"})}})}function i(q,p){var o={client_id:d,v:5,ru:"http://wap.sogou.com"};p=p||n;$.extend(o,q);$.ajax({url:"/wap/findpwd/reset",type:"post",data:o,dataType:"json",success:function(r){if("string"===typeof r){try{r=JSON.parse(r)}catch(s){r={status:1,statusText:"格式错误"}}}if(r&&!+r.status){return p(true,r.data)}else{return p(false,r)}},error:function(){return p(false,{statusText:"提交失败"})}})}function m(q,p){var o={client_id:d,v:0,ru:"http://wap.sogou.com"};p=p||n;$.extend(o,q);$.ajax({url:"/wap/reguser",type:"post",data:o,dataType:"json",success:function(r){if("string"===typeof r){try{r=JSON.parse(r)}catch(s){r={status:1,statusText:"格式错误"}}}if(r&&!+r.status){return p(true,r.data)}else{return p(false,r)}},error:function(){return p(false,{statusText:"注册失败"})}})}return{client_id:d,checkNeedCaptcha:e,getCaptcha:f,login:k,checkusername:l,sendsms:j,checksms:a,findpwdCheck:h,findpwdSendmail:b,register:m,reset:i,findpwdSendsms:g}});define("lib/tpl",[],function(){return function(i){var f=/<%(.+?)%>/mg;var g,e;var h=0;var d=[];var a;var b='with(__data){var _tpl="";';i=i.replace(/[\r\n]/mg,"");while(g=f.exec(i)){b+='_tpl+="'+(i.slice(h,g.index)).replace(/"/mg,'\\"')+'";';h=g[0].length+g.index;e=g;switch(true){case /\s*for\s+(\w+)\s+in\s+(\w+)\s*/.test(g[1]):b+="for(var _i=0,"+RegExp.$1+",loop;_i<"+RegExp.$2+".length;++_i){"+RegExp.$1+"="+RegExp.$2+"[_i];loop={index:_i+1,index0:_i,first:(_i===0),last:(_i+1==="+RegExp.$2+".length)};";break;case /\s*(endfor|endif)\s*/.test(g[1]):b+="}";break;case /\s*if\s*([\w<>=\|\^&\*\(\)!\+\-\. ]+)/.test(g[1]):a=RegExp.$1.replace(/\band\b/ig,"&&");a=a.replace(/\bor\b/ig,"||");b+="if("+a+"){";break;case new RegExp("=([\\w\\.\\[\\]\"'\\-\\| ]+)").test(g[1]):b+="_tpl+="+RegExp.$1+";";break;case /\s*else\s*/.test(g[1]):b+="}else{";break;default:console.error(g[1])}}b+='_tpl+="'+(i.slice(e.index+e[0].length)).replace(/"/mg,'\\"')+'";';b+="return _tpl;}";return new Function("__data",b)}});define("wap/local",[],function(){var a={load:function(b){try{return JSON.parse(localStorage.getItem(b))||{}}catch(d){return{}}},save:function(d,f){var b=f;if("string"!==typeof f){b=JSON.stringify(f)}try{localStorage.setItem(d,b)}catch(g){}}};return a});define("lib/emitter",[],function(){function a(){var b={};this.on=function(d,f,e){if(!b[d]){b[d]=[]}b[d].push({thisArg:e,func:f,type:d})};this.emit=function(d,e){if(Array.isArray(b[d])){b[d].forEach(function(f){f.func.call(f.thisArg||null,f,e)})}}}return a});define("wap/utils",[],function(){var a=null;return{getUrlParams:function(){if(a){return a}var d=location.search.split("#")[0].split(/[?&]/g);var b;a={};d.forEach(function(e){if((b=e.match(/^([\w-]+)=([^&=\?#]+)/))&&b[1]&&b[2]){a[b[1]]=b[2]}});return a},getRu:function(){var d=this.getUrlParams();var b=d.ru;if(!/https?:\/\/([\w-]+\.)+sogou.com/.test(decodeURIComponent(b))){b=encodeURIComponent("http://wap.sogou.com")}return b},getPassThroughParams:function(){var e=[];var d=this.getUrlParams(),b=this.getRu();if(d.client_id){e.push("client_id="+d.client_id)}if(d.v){e.push("v="+d.v)}if(d.skin){e.push("skin="+d.skin)}if(b){e.push("ru="+b)}return e.join("&")}}});define("wap/skin",["./utils"],function(a){var b={init:function(){var d=a.getUrlParams();if(d.skin){this.loadSkin(d.skin)}return this},loadSkin:function(d){switch(true){case /caipiao|cp|red|lottery/i.test(d):d="cp";break;default:d=null}if(d){$(document.body).addClass("skin_"+d)}}};return b.init()});var hexcase=0;function hex_md5(b){return rstr2hex(rstr_md5(str2rstr_utf8(b)))}function hex_hmac_md5(e,d){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(d)))}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(b){return binl2rstr(binl_md5(rstr2binl(b),b.length*8))}function rstr_hmac_md5(n,k){var l=rstr2binl(n);if(l.length>16){l=binl_md5(l,n.length*8)}var i=Array(16),m=Array(16);for(var h=0;h<16;h++){i[h]=l[h]^909522486;m[h]=l[h]^1549556828}var j=binl_md5(i.concat(rstr2binl(k)),512+k.length*8);return binl2rstr(binl_md5(m.concat(j),512+128))}function rstr2hex(l){try{hexcase}catch(i){hexcase=0}var j=hexcase?"0123456789ABCDEF":"0123456789abcdef";var e="";var h;for(var k=0;k<l.length;k++){h=l.charCodeAt(k);e+=j.charAt((h>>>4)&15)+j.charAt(h&15)}return e}function str2rstr_utf8(j){var f="";var i=-1;var g,h;while(++i<j.length){g=j.charCodeAt(i);h=i+1<j.length?j.charCodeAt(i+1):0;if(55296<=g&&g<=56319&&56320<=h&&h<=57343){g=65536+((g&1023)<<10)+(h&1023);i++}if(g<=127){f+=String.fromCharCode(g)}else{if(g<=2047){f+=String.fromCharCode(192|((g>>>6)&31),128|(g&63))}else{if(g<=65535){f+=String.fromCharCode(224|((g>>>12)&15),128|((g>>>6)&63),128|(g&63))}else{if(g<=2097151){f+=String.fromCharCode(240|((g>>>18)&7),128|((g>>>12)&63),128|((g>>>6)&63),128|(g&63))}}}}}return f}function rstr2binl(d){var e=Array(d.length>>2);for(var f=0;f<e.length;f++){e[f]=0}for(var f=0;f<d.length*8;f+=8){e[f>>5]|=(d.charCodeAt(f/8)&255)<<(f%32)}return e}function binl2rstr(d){var e="";for(var f=0;f<d.length*32;f+=8){e+=String.fromCharCode((d[f>>5]>>>(f%32))&255)}return e}function binl_md5(a,r){a[r>>5]|=128<<((r)%32);a[(((r+64)>>>9)<<4)+14]=r;var b=1732584193;var d=-271733879;var i=-1732584194;var q=271733878;for(var v=0;v<a.length;v+=16){var s=b;var t=d;var w=i;var x=q;b=md5_ff(b,d,i,q,a[v+0],7,-680876936);q=md5_ff(q,b,d,i,a[v+1],12,-389564586);i=md5_ff(i,q,b,d,a[v+2],17,606105819);d=md5_ff(d,i,q,b,a[v+3],22,-1044525330);b=md5_ff(b,d,i,q,a[v+4],7,-176418897);q=md5_ff(q,b,d,i,a[v+5],12,1200080426);i=md5_ff(i,q,b,d,a[v+6],17,-1473231341);d=md5_ff(d,i,q,b,a[v+7],22,-45705983);b=md5_ff(b,d,i,q,a[v+8],7,1770035416);q=md5_ff(q,b,d,i,a[v+9],12,-1958414417);i=md5_ff(i,q,b,d,a[v+10],17,-42063);d=md5_ff(d,i,q,b,a[v+11],22,-1990404162);b=md5_ff(b,d,i,q,a[v+12],7,1804603682);q=md5_ff(q,b,d,i,a[v+13],12,-40341101);i=md5_ff(i,q,b,d,a[v+14],17,-1502002290);d=md5_ff(d,i,q,b,a[v+15],22,1236535329);b=md5_gg(b,d,i,q,a[v+1],5,-165796510);q=md5_gg(q,b,d,i,a[v+6],9,-1069501632);i=md5_gg(i,q,b,d,a[v+11],14,643717713);d=md5_gg(d,i,q,b,a[v+0],20,-373897302);b=md5_gg(b,d,i,q,a[v+5],5,-701558691);q=md5_gg(q,b,d,i,a[v+10],9,38016083);i=md5_gg(i,q,b,d,a[v+15],14,-660478335);d=md5_gg(d,i,q,b,a[v+4],20,-405537848);b=md5_gg(b,d,i,q,a[v+9],5,568446438);q=md5_gg(q,b,d,i,a[v+14],9,-1019803690);i=md5_gg(i,q,b,d,a[v+3],14,-187363961);d=md5_gg(d,i,q,b,a[v+8],20,1163531501);b=md5_gg(b,d,i,q,a[v+13],5,-1444681467);q=md5_gg(q,b,d,i,a[v+2],9,-51403784);i=md5_gg(i,q,b,d,a[v+7],14,1735328473);d=md5_gg(d,i,q,b,a[v+12],20,-1926607734);b=md5_hh(b,d,i,q,a[v+5],4,-378558);q=md5_hh(q,b,d,i,a[v+8],11,-2022574463);i=md5_hh(i,q,b,d,a[v+11],16,1839030562);d=md5_hh(d,i,q,b,a[v+14],23,-35309556);b=md5_hh(b,d,i,q,a[v+1],4,-1530992060);q=md5_hh(q,b,d,i,a[v+4],11,1272893353);i=md5_hh(i,q,b,d,a[v+7],16,-155497632);d=md5_hh(d,i,q,b,a[v+10],23,-1094730640);b=md5_hh(b,d,i,q,a[v+13],4,681279174);q=md5_hh(q,b,d,i,a[v+0],11,-358537222);i=md5_hh(i,q,b,d,a[v+3],16,-722521979);d=md5_hh(d,i,q,b,a[v+6],23,76029189);b=md5_hh(b,d,i,q,a[v+9],4,-640364487);q=md5_hh(q,b,d,i,a[v+12],11,-421815835);i=md5_hh(i,q,b,d,a[v+15],16,530742520);d=md5_hh(d,i,q,b,a[v+2],23,-995338651);b=md5_ii(b,d,i,q,a[v+0],6,-198630844);q=md5_ii(q,b,d,i,a[v+7],10,1126891415);i=md5_ii(i,q,b,d,a[v+14],15,-1416354905);d=md5_ii(d,i,q,b,a[v+5],21,-57434055);b=md5_ii(b,d,i,q,a[v+12],6,1700485571);q=md5_ii(q,b,d,i,a[v+3],10,-1894986606);i=md5_ii(i,q,b,d,a[v+10],15,-1051523);d=md5_ii(d,i,q,b,a[v+1],21,-2054922799);b=md5_ii(b,d,i,q,a[v+8],6,1873313359);q=md5_ii(q,b,d,i,a[v+15],10,-30611744);i=md5_ii(i,q,b,d,a[v+6],15,-1560198380);d=md5_ii(d,i,q,b,a[v+13],21,1309151649);b=md5_ii(b,d,i,q,a[v+4],6,-145523070);q=md5_ii(q,b,d,i,a[v+11],10,-1120210379);i=md5_ii(i,q,b,d,a[v+2],15,718787259);d=md5_ii(d,i,q,b,a[v+9],21,-343485551);b=safe_add(b,s);d=safe_add(d,t);i=safe_add(i,w);q=safe_add(q,x)}return Array(b,d,i,q)}function md5_cmn(a,j,k,l,b,i){return safe_add(bit_rol(safe_add(safe_add(j,a),safe_add(l,i)),b),k)}function md5_ff(m,n,a,b,o,d,l){return md5_cmn((n&a)|((~n)&b),m,n,o,d,l)}function md5_gg(m,n,a,b,o,d,l){return md5_cmn((n&b)|(a&(~b)),m,n,o,d,l)}function md5_hh(m,n,a,b,o,d,l){return md5_cmn(n^a^b,m,n,o,d,l)}function md5_ii(m,n,a,b,o,d,l){return md5_cmn(a^(n|(~b)),m,n,o,d,l)}function safe_add(f,g){var h=(f&65535)+(g&65535);var e=(f>>16)+(g>>16)+(h>>16);return(e<<16)|(h&65535)}function bit_rol(e,d){return(e<<d)|(e>>>(32-d))}define("lib/md5-min",function(){});define("wap/login",["./interface","../lib/tpl","./local","../lib/emitter","./utils","./skin","../lib/md5-min"],function(f,k,g,i,h){var j="login-history";var b=h.getRu();var a=h.getPassThroughParams();var e={$history:$(".history"),SELECTEVENT:"select-event",init:function(){var l=this;l.listFunc=k($("#history-tpl").html());this.$history.delegate(".rm","click",function(m){m.preventDefault();var n=$(this).attr("data-id");l.removeItem(n);$(this).parent("li").remove()}).delegate(".hisname,.check","click",function(n){var m=$(this).parent("li").find(".hisname").text().trim();l.emit(l.SELECTEVENT,m)}).html(this.listFunc({list:this.listItems()}))},removeItem:function(m){var l=g.load(j);if(Array.isArray(l)&&l.length){l=l.filter(function(n){return n!=m});g.save(j,l)}},addItem:function(m){var l=g.load(j);if(!Array.isArray(l)){l=[]}if(!!~l.indexOf(m)){return}l.push(m);g.save(j,l)},listItems:function(){var l=g.load(j);if(!Array.isArray(l)){l=[]}return l}};$.extend(e,new i());var d={$form:$("form"),$captchaWrapper:$("#captcha-wrapper"),$username:$("#username"),$password:$("#password"),$showpass:$("#showpass"),$captchaImg:$("#captcha-img"),$captcha:$("#captcha"),$msg:$(".msg"),__mLogining:false,init:function(){e.init();e.on(e.SELECTEVENT,this.onHistorySelect,this);$(".backlink").click(function(m){m.preventDefault();history.back()});$(".trd-qq").attr("href","https://account.sogou.com/connect/login?provider=qq&type=wap&display=mobile&"+a);$(".reglink").attr("href","/wap/reg?"+a);$(".forgot").attr("href","/wap/findpwd?"+a);var l;if(l=h.getUrlParams().phone){this.$username.val(l)}return this.initEvt()},initEvt:function(){var l=this;l.$username.blur(function(m){m.target.value&&f.checkNeedCaptcha(m.target.value,function(n){l.$captchaWrapper.toggleClass("hide",!n);n&&l.$captchaImg.attr("src",f.getCaptcha(token))})});l.$captchaImg.click(function(m){$(this).attr("src",f.getCaptcha(token))});l.$showpass.change(function(m){l.$password.attr("type",!this.checked?"password":"text");if(this.checked){$(this).siblings("label").find(".circle").removeClass("grey").addClass("blue")}else{$(this).siblings("label").find(".circle").removeClass("blue").addClass("grey")}});l.$form.submit(function(o){o.preventDefault();var m=$.trim(l.$username.val());var n=$.trim(l.$password.val());var q=$.trim(l.$captcha.val());if(!m||!n){return l.showMsg("请输入用户名或密码")}if(n.length<6){return l.showMsg("密码至少6位")}if(l.__mLogining){return false}l.__mLogining=true;return f.login({token:token,captcha:q,username:m,password:hex_md5(n)},function(r,p){l.__mLogining=false;if(r){e.addItem(m);l.showMsg("登录成功",true);b=decodeURIComponent(b);if(b){b=b.split("#")[0];if(~b.indexOf("?")){if(b[b.length-1]!=="?"){b+="&"}}else{b+="?"}location.assign(b+"sgid="+p.sgid)}}else{l.showMsg(p.statusText);if(p.status=="20221"||p.status=="20257"){l.$captcha.empty().focus();l.showCaptcha()}else{l.$password.empty().focus();if(!l.$captchaWrapper.hasClass("hide")){l.showCaptcha()}}}})});return this},onHistorySelect:function(l,m){this.$username.val(m)},showCaptcha:function(){this.$captchaWrapper.removeClass("hide");this.$captchaImg.attr("src",f.getCaptcha(token))},showMsg:function(l,m){if(m){this.$msg.find(".circle").removeClass("hide red").addClass("green");this.$msg.find(".circle .sprite").removeClass("sprite-wrong").addClass("sprite-right")}else{this.$msg.find(".circle").removeClass("hide green").addClass("red");this.$msg.find(".circle .sprite").removeClass("sprite-right").addClass("sprite-wrong")}this.$msg.find(".info").text(l);return this}};return d});define("wap/reg",["./interface","./utils","./local","./skin"],function(d,g,h){var a=g.getRu();var f=g.getPassThroughParams();var b={$container:$(".dialog"),$mask:$(".mask"),init:function(){var i=this;i.$container.on("click",".x",function(j){j.preventDefault();i.hide()});i.$mask.click(function(){i.hide()})},show:function(){this.$mask.removeClass("hide");this.$container.removeClass("hide")},hide:function(){this.$mask.addClass("hide");this.$container.addClass("hide")}};var e={$form:$("form"),$username:$("#username"),$password:$("#password"),$showpass:$("#showpass"),$sms:$("#sms"),$sendsms:$(".sendsms"),$msg:$(".msg"),__SendingSms:false,__smsSent:false,__mReging:false,init:function(){$(".backlink").click(function(i){i.preventDefault();history.back()});$(".tologin").attr("href","/wap/index?"+f);return this.initEvt()},initEvt:function(){var i=this;i.$username.on("input",function(k){var j=k.target.value;if(/[^\d]/.test(j)){return i.showMsg("请输入11位手机号")}else{i.hideMsg()}if(!/^1\d{10}$/.test(j)){return}d.checkusername(j,function(l){if(!l){$(".tologin").attr("href","/wap/index?"+f+"&phone="+j);b.show()}})});i.$showpass.change(function(j){i.$password.attr("type",!this.checked?"password":"text");if(this.checked){$(this).siblings("label").find(".circle").removeClass("grey").addClass("blue")}else{$(this).siblings("label").find(".circle").removeClass("blue").addClass("grey")}});i.$sendsms.click(function(k){k.preventDefault();var j=i.$username.val();if(!/^1\d{10}$/.test(j)){return i.showMsg("请输入11位手机号")}if(i.__SendingSms){return}i.__SendingSms=true;d.sendsms(j,function(o,n){i.showMsg(o?"验证码发送成功":n.statusText,o);if(o){i.__smsSent=true;i.$sendsms.addClass("disabled");var m=60,l=i.$sendsms.text();var p=setInterval(function(){i.$sendsms.text(m--+"秒后可重发");if(m<0){i.$sendsms.text(l);clearInterval(p);i.__SendingSms=false;i.$sendsms.removeClass("disabled")}},1000)}else{i.__SendingSms=false}})});i.$form.submit(function(l){l.preventDefault();var j=$.trim(i.$username.val());var k=$.trim(i.$password.val());var m=$.trim(i.$sms.val());if(!j||!k||!m){return i.showMsg("请输入用户名/密码/验证码")}if(k.length<6){return i.showMsg("密码至少6位")}if(!/^1\d{10}$/.test(j)){return i.showMsg("请输入11位手机号")}if(!i.__smsSent){return i.showMsg("您还没有获取短信验证码")}if(i.__mReging){return}i.__mReging=true;return d.register({captcha:m,username:j,password:k},function(o,n){i.__mReging=false;if(o){i.showMsg("注册成功",true);a=decodeURIComponent(a);if(a){a=a.split("#")[0];if(~a.indexOf("?")){if(a[a.length-1]!=="?"){a+="&"}}else{a+="?"}location.assign(a+"sgid="+n.sgid)}}else{i.showMsg(n.statusText);if(n.status=="20221"||n.status=="20216"){i.$sms.empty().focus()}else{i.$password.empty().focus()}}})});return this},showMsg:function(i,j){if(j){this.$msg.find(".circle").removeClass("hide red").addClass("green");this.$msg.find(".circle .sprite").removeClass("sprite-wrong").addClass("sprite-right")}else{this.$msg.find(".circle").removeClass("hide green").addClass("red");this.$msg.find(".circle .sprite").removeClass("sprite-right").addClass("sprite-wrong")}this.$msg.find(".info").text(i);return this},hideMsg:function(){this.$msg.find(".circle").addClass("hide");this.$msg.find(".info").empty()}};return{init:function(){b.init();e.init()}}});define("wap/common",["./utils"],function(b){var a=b.getPassThroughParams();$(".backlink").click(function(d){d.preventDefault();history.back()});$("nav a").each(function(d,f){var e=$(f).attr("href");$(f).attr("href",e.indexOf("?")==-1?(e+"?"+a):(e+"&"+a))});return{}});define("wap/findpwd",["./interface","./utils","./skin","./common"],function(b,f){var a=f.getRu();var e=f.getPassThroughParams();var d={$form:$("form"),$username:$("#username"),$sms:$("#sms"),$sendsms:$(".sendsms"),$msg:$(".msg"),__SendingSms:false,__smsSent:false,__mFinding:false,init:function(){$(".links a").each(function(g,i){var h=$(i).attr("href");$(i).attr("href",h.indexOf("?")==-1?(h+"?"+e):(h+"&"+e))});return this.initEvt()},initEvt:function(){var g=this;g.$username.on("input",function(i){var h=i.target.value;if(/[^\d]/.test(h)){return g.showMsg("请输入11位手机号")}else{g.hideMsg()}if(!/^1\d{10}$/.test(h)){return}});g.$sendsms.click(function(i){i.preventDefault();var h=g.$username.val();if(!/^1\d{10}$/.test(h)){return g.showMsg("请输入11位手机号")}if(g.__SendingSms){return}g.__SendingSms=true;b.findpwdSendsms(h,function(m,l){g.showMsg(m?"验证码发送成功":l.statusText,m);if(m){g.__smsSent=true;g.$sendsms.addClass("disabled");var k=60,j=g.$sendsms.text();var n=setInterval(function(){g.$sendsms.text(k--+"秒后可重发");if(k<0){g.$sendsms.text(j);clearInterval(n);g.__SendingSms=false;g.$sendsms.removeClass("disabled")}},1000)}else{g.__SendingSms=false}})});g.$form.submit(function(i){i.preventDefault();var h=$.trim(g.$username.val());var j=$.trim(g.$sms.val());if(!h||!j){return g.showMsg("请输入用户名/验证码")}if(!/^1\d{10}$/.test(h)){return g.showMsg("请输入11位手机号")}if(!g.__smsSent){return g.showMsg("您还没有获取短信验证码")}if(g.__mFinding){return}g.__mFinding=true;return b.checksms({smscode:j,mobile:h,skin:f.getUrlParams()["skin"],ru:decodeURIComponent(a)},function(l,k){g.__mFinding=false;if(l){location.href=k.url}else{g.showMsg(k.statusText);if(k.status=="20221"||k.status=="20216"){g.$sms.empty().focus()}else{g.$password.empty().focus()}}})});return this},showMsg:function(g,h){if(h){this.$msg.find(".circle").removeClass("hide red").addClass("green");this.$msg.find(".circle .sprite").removeClass("sprite-wrong").addClass("sprite-right")}else{this.$msg.find(".circle").removeClass("hide green").addClass("red");this.$msg.find(".circle .sprite").removeClass("sprite-right").addClass("sprite-wrong")}this.$msg.find(".info").text(g);return this},hideMsg:function(){this.$msg.find(".circle").addClass("hide");this.$msg.find(".info").empty()}};return{init:function(){d.init()}}});define("wap/findpwd_other",["./interface","../lib/tpl","./utils","./skin","./common"],function(b,g,f){var a=f.getRu();var e=f.getPassThroughParams();var d={$form:$("form"),$username:$("#username"),$sms:$("#sms"),$sendsms:$(".sendsms"),$captchaImg:$("#captcha-img"),$captcha:$("#captcha"),$confirmTpl:$("#FindpwdConfirm").html(),$msg:$(".msg"),__mFinding:false,__currentStep:1,showCaptcha:function(){this.$captchaImg.attr("src",b.getCaptcha(token))},init:function(){this.showCaptcha();$(".links a").each(function(h,j){var i=$(j).attr("href");$(j).attr("href",i.indexOf("?")==-1?(i+"?"+e):(i+"&"+e))});return this.initEvt()},initEvt:function(){var h=this;h.$captchaImg.click(function(i){h.showCaptcha()});h.$form.submit(function(j){j.preventDefault();if(h.__currentStep==1){var i=$.trim(h.$username.val());var k=$.trim(h.$captcha.val());if(!i||!k){return h.showMsg("请输入用户名/验证码")}if(h.__mFinding){return}h.__mFinding=true;return b.findpwdCheck({token:token,captcha:k,username:i,ru:decodeURIComponent(a)},function(m,l){h.__mFinding=false;if(m){if(l.url&&l.url.length){location.href=l.url}else{if(l.sec_process_email){h.$form.html(g(h.$confirmTpl)({email:l.sec_process_email}));h.__confirmData=l;h.__currentStep=2}else{location.href="/wap/findpwd/kefu?"+e}}}else{h.showMsg(l.statusText);h.$captcha.empty();h.showCaptcha();if(l.status=="20221"){h.$captcha.focus()}}})}else{if(h.__currentStep==2){if(h.__mFinding){return}h.__mFinding=true;return b.findpwdSendmail({username:h.__confirmData.userid,scode:h.__confirmData.scode,email:h.__confirmData.sec_email,skin:f.getUrlParams()["skin"],ru:decodeURIComponent(a)},function(m,l){h.__mFinding=false;if(m){$("form").html('<p class="reset-notify">'+(l.statusText||"找回密码邮件已发送，请尽快查看邮件并修改密码")+"</p>");setTimeout(function(){location.href="/wap/index?"+e},2000)}else{h.showMsg(l.statusText);h.$captcha.empty();h.showCaptcha();if(l.status=="20221"){h.$captcha.focus()}}})}}});return this},showMsg:function(h,i){if(i){this.$msg.find(".circle").removeClass("hide red").addClass("green");this.$msg.find(".circle .sprite").removeClass("sprite-wrong").addClass("sprite-right")}else{this.$msg.find(".circle").removeClass("hide green").addClass("red");this.$msg.find(".circle .sprite").removeClass("sprite-right").addClass("sprite-wrong")}this.$msg.find(".info").text(h);return this},hideMsg:function(){this.$msg.find(".circle").addClass("hide");this.$msg.find(".info").empty()}};return d});define("wap/resetpwd",["./interface","../lib/tpl","./utils","./skin","./common"],function(b,g,f){var a=f.getRu();var e=f.getPassThroughParams();var d={$form:$("form"),__mChanging:false,init:function(){this.__data={};try{this.__data=JSON.parse(window.data)}catch(h){}if(+this.__data.status===0){this.__data=this.__data.data;this.$form.html(g(this.$form.find("script").html())({userid:this.__data.userid}));this.$password=$("#password");this.$cpassowrd=$("#cpassword");this.$msg=$(".msg");return this.initEvt()}else{this.$form.html('<p class="reset-notify">'+(this.__data.statusText||"找回密码邮件已发送，请尽快查看邮件并修改密码")+"</p>");return}},initEvt:function(){var h=this;h.$form.submit(function(j){j.preventDefault();var i=$.trim(h.$password.val());var k=$.trim(h.$cpassowrd.val());if(!i||!k){return h.showMsg("请输入密码")}if(i!=k){return h.showMsg("确认密码不一致")}if(i.length<6){return h.showMsg("密码至少6位")}if(h.__mChanging){return}h.hideMsg();h.__mChanging=true;return b.reset({password:i,username:h.__data.userid,scode:h.__data.scode,ru:decodeURIComponent(a)},function(m,l){h.__mChanging=false;if(m){h.showMsg("恭喜您，重置密码成功！",true);setTimeout(function(){location.href="/wap/index?"+e},2000)}else{h.showMsg(l.statusText);if(l.status=="20221"||l.status=="20216"){h.$sms.empty().focus()}else{h.$password.empty().focus()}}})});return this},showMsg:function(h,i){if(i){this.$msg.find(".circle").removeClass("hide red").addClass("green");this.$msg.find(".circle .sprite").removeClass("sprite-wrong").addClass("sprite-right")}else{this.$msg.find(".circle").removeClass("hide green").addClass("red");this.$msg.find(".circle .sprite").removeClass("sprite-right").addClass("sprite-wrong")}this.$msg.find(".info").text(h);this.$msg.removeClass("hide");return this},hideMsg:function(){this.$msg.find(".circle").addClass("hide");this.$msg.find(".info").empty();this.$msg.addClass("hide")}};return d});define("wap/findpwd_confirm",["./interface","./utils","./skin","./common"],function(b,f){var a=f.getRu();var e=f.getPassThroughParams();var d={$form:$("form"),__mFinding:false,init:function(){return this.initEvt()},initEvt:function(){var g=this;g.$form.submit(function(h){h.preventDefault();return b.check({captcha:c,username:u},function(j,i){g.__mFinding=false;if(j){g.showMsg("注册成功",true);a=decodeURIComponent(a);if(a){a=a.split("#")[0];if(~a.indexOf("?")){if(a[a.length-1]!=="?"){a+="&"}}else{a+="?"}location.assign(a+"sgid="+i.sgid)}}else{g.showMsg(i.statusText);if(i.status=="20221"||i.status=="20216"){g.$sms.empty().focus()}else{g.$password.empty().focus()}}})});return this},showMsg:function(g,h){if(h){this.$msg.find(".circle").removeClass("hide red").addClass("green");this.$msg.find(".circle .sprite").removeClass("sprite-wrong").addClass("sprite-right")}else{this.$msg.find(".circle").removeClass("hide green").addClass("red");this.$msg.find(".circle .sprite").removeClass("sprite-right").addClass("sprite-wrong")}this.$msg.find(".info").text(g);return this},hideMsg:function(){this.$msg.find(".circle").addClass("hide");this.$msg.find(".info").empty()}};return d});define("wap",["./wap/login","./wap/reg","./wap/findpwd","./wap/findpwd_other","./wap/resetpwd","./wap/findpwd_confirm"],function(g,b,a,e,f,d){return{index_touch:function(){g.init()},regist_touch:function(){b.init()},findpwd_touch:function(){a.init()},findpwd_other_touch:function(){e.init()},findpwd_confirm_touch:function(){d.init()},resetpwd_touch:function(){f.init()}}});